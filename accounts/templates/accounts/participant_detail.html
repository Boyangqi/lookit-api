{% extends 'exp/base.html' %}
{% load bootstrap3 %}
{% load exp_extras %}

{% block title %}{{ user.get_full_name }}{% endblock %}
{% block flash %}
  {% bootstrap_messages %}
{% endblock %}
{% block content %}
  <div class="container mb-lg">
      <div class="row">
          <div class="col-xs-12">
              <a href="{% url 'exp:participant-list' %}"> All Participants </a> > {{ user.get_short_name }} </a>
          </div>
      </div>

      <div class="row">
          <div class="col-xs-12">
              <h1> {{ user.get_full_name }} </h1>
              <span class="pr-md"><label class='pr-xs'> Email: </label> {{ user.username }} </span>
              <span><label class='pr-xs'> Last Active: </label> {{ user.last_login|date:"n/d/Y"|default:"N/A" }} </span>
          </div>
      </div>

    <div class='row'>
        <div class='col-sm-6'>
            <h3>Children</h3>
            {% if children %}
                <ul>
                {% for child in children %}
                    <li><h4>{{child.name}}</h4></li>
                    <div><b>Birthday:</b> {{child.birthday|date:"n/d/Y"|default:"N/A"}}</div>
                    <div><b>Gender:</b> {{child.gender}}</div>
                    <div><b>Participant's Age at Child's Birth:</b> {{child.age_at_birth}}</div>
                    <div><b>Age:</b> {{child.age}}</div>
                    <div><b>Extra:</b> {{child.extra}}</div>
                {% endfor %}
                </ul>
            {% else %}
                <p><em> No children profiles registered! </em></p>
            {% endif %}
        </div>
        <div class='col-sm-6'>
            <h3>Latest Demographic Data</h3>
            <div><b>Number of Children:</b> {{ demographics.number_of_children }}</div>
            <div><b>Children Birthdays:</b> {% for birthday in user.latest_demographics.child_birthdays %}{{birthday|date:"n/d/Y"|default:"N/A"}}{% if not forloop.last %}, {% endif %}{% endfor %}</div>
            <div><b>Laguages Spoken at Home:</b> {{ demographics.languages_spoken_at_home }}</div>
            <div><b>Number of Guardians:</b> {{ demographics.number_of_guardians }}</div>
            <div><b>Explanation for Guardians:</b> {{ demographics.number_of_guardians_explanation }}</div>
            <div><b>Race:</b> {{ demographics.race_identification }}</div>
            <div><b>Age:</b> {{ demographics.age }}</div>
            <div><b>Gender:</b> {{ demographics.gender }}</div>
            <div><b>Education Level:</b> {{ demographics.education_level }}</div>
            <div><b>Spouse's Education Level:</b> {{ demographics.spouse_education_level }}</div>
            <div><b>Annual Income:</b> {{ demographics.annual_income }}</div>
            <div><b>Books at Home:</b> {{ demographics.number_of_books }}</div>
            <div><b>Additional Comments:</b> {{ demographics.additional_comments }}</div>
            <div><b>Country:</b> {{ demographics.country }}</div>
            <div><b>State:</b> {{ demographics.state }}</div>
            <div><b>Density:</b> {{ demographics.density }}</div>
        </div>
    </div>
    <h3>{{ user.given_name}}'s Studies</h3>
    <div class="row">
        <div class="col-sm-6">
            Study Title
            <a href="{% url 'exp:participant-detail' user.id  %}?{% query_transform request sort='name' %}"><i aria-hidden="true" class="fa fa-chevron-up" role="button" name="name"></i></a>
            <a href="{% url 'exp:participant-detail' user.id  %}?{% query_transform request sort='-name' %}"><i aria-hidden="true" class="fa fa-chevron-down" role="button" name="name"></i></a>
        </div>
        <div class="col-sm-3">
            Completion Status
            <a href="{% url 'exp:participant-detail' user.id  %}?{% query_transform request sort='state' %}"><i aria-hidden="true" class="fa fa-chevron-up" role="button" name="name"></i></a>
            <a href="{% url 'exp:participant-detail' user.id  %}?{% query_transform request sort='-state' %}"><i aria-hidden="true" class="fa fa-chevron-down" role="button" name="name"></i></a>
        </div>
        <div class="col-sm-3">
            Date Modified
            <a href="{% url 'exp:participant-detail' user.id  %}?{% query_transform request sort='date_modified' %}"><i aria-hidden="true" class="fa fa-chevron-up" role="button" name="name"></i></a>
            <a href="{% url 'exp:participant-detail' user.id  %}?{% query_transform request sort='-date_modified' %}"><i aria-hidden="true" class="fa fa-chevron-down" role="button" name="name"></i></a>
        </div>
    </div>
    {% for study_dict in studies %}
    <div class="row pt-sm">
        <div class="col-sm-6 col-xs-12">
            <a href="{% url 'exp:study-detail' study_dict.study.id %}">{{ study_dict.study.name }}</a>
        </div>
        <div class="col-sm-3 col-xs-12">
            <span class="visible-xs">Status: </span>
            {% if study_dict.completed %}
                Completed
            {% else %}
                In Progress
            {% endif %}
        </div>
        <div class="col-sm-3 col-xs-12">
            {{ study_dict.study.date_modified|date:"n/d/Y"|default:"N/A" }}
        </div>
    </div>
  {% endfor %}
  </div>
</div>
{% endblock %}
